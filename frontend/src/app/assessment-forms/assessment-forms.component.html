<article>
    <h1 i18n>Step 2: Assessment Forms</h1>

    <p i18n>
        In this step, you will receive information on how students can make use
        of GenAI for the assessment forms in your course.
    </p>

    <p i18n>
        After adding an assessment form, you decide whether the use of GenAI is
        a problem in this context, based on the ILOs that are tested. If you
        consider the use of GenAI in the assessment a problem, the tool suggests
        alternatives.
    </p>

    <p i18n>
        Next, pick one or more intended learning outcomes that are assessed in
        this way and whose assessment could be affected by the use of GenAI.
    </p>

    @for (subForm of form.controls.assessmentForms.controls; track $index) {
    <div class="card">
        <div class="card-body">
            <form [formGroup]="subForm">
                <div class="d-flex justify-content-between">
                    <gr-assessment-form-select
                        [options]="availableOptionsFor($index)"
                        [formControl]="subForm.controls.assessmentId"
                    />
                    <div class="d-flex align-items-center gap-3">
                        <label
                            for="affected-true-{{ $index }}"
                            class="form-label mb-0"
                            i18n
                        >
                            Affected by GenAI?
                        </label>
                        <div class="form-check">
                            <input
                                id="affected-true-{{ $index }}"
                                class="form-check-input"
                                type="radio"
                                name="affected-{{ $index }}"
                                [value]="true"
                                [formControl]="subForm.controls.affected"
                            />
                            <label
                                for="affected-true-{{ $index }}"
                                class="form-check-label"
                                i18n
                            >
                                Yes
                            </label>
                        </div>
                        <div class="form-check">
                            <input
                                id="affected-false-{{ $index }}"
                                class="form-check-input"
                                type="radio"
                                name="affected-{{ $index }}"
                                [value]="false"
                                [formControl]="subForm.controls.affected"
                            />
                            <label
                                for="affected-false-{{ $index }}"
                                class="form-check-label"
                                i18n
                            >
                                No
                            </label>
                        </div>
                    </div>
                </div>

                @if (subForm.controls.affected.value === true) {
                <div [@expandIn] class="animated-row mt-4">
                    <label class="form-label fw-bold" i18n>
                        Select one or multiple affected ILOs
                    </label>
                    @for ( iloForm of form.controls.learningOutcomes.controls;
                    track iloForm.controls.id.value ) {
                    <gr-ilo-select
                        [formIndex]="$index"
                        [iloForm]="iloForm"
                        [formControl]="subForm.controls.iloIds"
                    ></gr-ilo-select>
                    } @empty {
                    <p class="text-muted" i18n>
                        No ILOs available. Add some in the previous step.
                    </p>
                    }
                    <div>
                        <p class="fw-bold">Adjustments</p>
                        <ul>
                            @for (adjustment of
                            getAdjustments(subForm.controls.assessmentId.value);
                            track $index) {
                            <li>{{ adjustment }}</li>
                            }
                        </ul>
                    </div>
                </div>
                }
            </form>
        </div>
        <div class="card-footer">
            <button
                type="button"
                class="btn btn-outline-secondary small btn-small"
                (click)="removeAssessmentForm($index)"
                i18n
            >
                Remove
            </button>
        </div>
    </div>
    }

    <button
        class="btn btn-outline-secondary"
        type="button"
        (click)="addAssessmentForm()"
        i18n
    >
        Add an assessment form
    </button>
</article>
<gr-nav-buttons [navButtons]="navButtons" />
