<article>
    <h1 i18n>Step 2: Assessment Forms</h1>

    <p i18n>
        In this step, you will receive information on how students can make use
        of GenAI for the assessment forms in your course.
    </p>

    <p i18n>
        After adding an assessment form, you decide whether the use of GenAI is
        a problem in this context, based on the ILOs that are tested. If you
        consider the use of GenAI in the assessment a problem, the tool suggests
        alternatives.
    </p>

    <p i18n>
        Next, pick one or more intended learning outcomes that are assessed in
        this way and whose assessment could be affected by the use of GenAI.
    </p>

    <div class="container">
        <div class="row">
            @for (subForm of form.controls.assessmentForms.controls; track
            $index) {
            <div class="col-md-6 col-xl-4 g-3">
                <div class="card rounded-4">
                    <div class="card-body position-relative py-4">
                        <div class="remove-button-wrapper">
                            <button
                                class="btn btn-sm btn-outline-danger"
                                type="button"
                                (click)="removeAssessmentForm($index)"
                                aria-labelledby="remove-assessment-form"
                                title="Remove assessment form"
                                title-i18n
                            >
                                <fa-icon
                                    [icon]="faTrash"
                                    aria-hidden="true"
                                    focusable="false"
                                ></fa-icon>
                                <span
                                    id="remove-assessment-form"
                                    class="visually-hidden"
                                    i18n
                                >
                                    Remove assessment form
                                </span>
                            </button>
                        </div>
                        <form [formGroup]="subForm">
                            <div>
                                <gr-assessment-form-select
                                    [options]="availableOptionsFor($index)"
                                    [formControl]="
                                        subForm.controls.assessmentId
                                    "
                                />
                                <div class="mt-4">
                                    <label
                                        for="affected-true-{{ $index }}"
                                        class="form-label fw-bold"
                                        i18n
                                    >
                                        Affected by GenAI?
                                    </label>
                                    <div class="form-check">
                                        <input
                                            id="affected-true-{{ $index }}"
                                            class="form-check-input"
                                            type="radio"
                                            name="affected-{{ $index }}"
                                            [value]="true"
                                            [formControl]="
                                                subForm.controls.affected
                                            "
                                        />
                                        <label
                                            for="affected-true-{{ $index }}"
                                            class="form-check-label"
                                            i18n
                                        >
                                            Yes
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input
                                            id="affected-false-{{ $index }}"
                                            class="form-check-input"
                                            type="radio"
                                            name="affected-{{ $index }}"
                                            [value]="false"
                                            [formControl]="
                                                subForm.controls.affected
                                            "
                                        />
                                        <label
                                            for="affected-false-{{ $index }}"
                                            class="form-check-label"
                                            i18n
                                        >
                                            No
                                        </label>
                                    </div>
                                </div>
                            </div>
                            @if (subForm.controls.affected.value === true) {
                            <div [@expandIn] class="animated-row mt-4">
                                <label class="form-label fw-bold" i18n>
                                    Select one or multiple affected ILOs
                                </label>
                                @for ( iloForm of
                                form.controls.learningOutcomes.controls; track
                                iloForm.controls.id.value ) {
                                <gr-ilo-select
                                    [formIndex]="$index"
                                    [iloForm]="iloForm"
                                    [formControl]="subForm.controls.iloIds"
                                ></gr-ilo-select>
                                } @empty {
                                <p class="text-muted" i18n>
                                    No ILOs available. Add some in the previous
                                    step.
                                </p>
                                }
                                <div class="mt-4">
                                    <p class="fw-bold" i18n>
                                        Suggested adjustments
                                    </p>
                                    <ul>
                                        @for (adjustment of
                                        getAdjustments(subForm.controls.assessmentId.value);
                                        track $index) {
                                        <li>
                                            {{ adjustment }}
                                        </li>
                                        } @empty {
                                        <p class="text-muted" i18n>
                                            No adjustments available. Select an
                                            assessment form first.
                                        </p>
                                        }
                                    </ul>
                                </div>
                            </div>
                            }
                        </form>
                    </div>
                </div>
            </div>
            }
            <div class="col-md-6 col-xl-4 g-3 d-flex align-items-center">
                <button
                    class="btn btn-outline-dark d-flex flex-column"
                    (click)="addAssessmentForm()"
                    aria-labelledby="add-assessment-form"
                    title="Add assessment form"
                    title-i18n
                >
                    <fa-icon
                        [icon]="faPlus"
                        aria-hidden="true"
                        focusable="false"
                    ></fa-icon>
                    <span id="add-assessment-form" i18n>Add form</span>
                </button>
            </div>
        </div>
    </div>
</article>

<gr-nav-buttons [navButtons]="navButtons" />
